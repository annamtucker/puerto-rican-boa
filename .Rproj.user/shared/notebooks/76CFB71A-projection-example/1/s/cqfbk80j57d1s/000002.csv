"0","N = matrix(NA, nrow = 4, ncol = 30)"
"0","N[,1] <- init$`Initial number, natural habitat`[1:4]"
"0","  "
"0","# project with temporal variation"
"0","for(i in 2:30){"
"0","    "
"0","  # set fecundity = 0 if pop exceeds K"
"0","  if(sum(N[,i-1]) > (K*0.913)){"
"0","    mat[i-1,1,3:4] <- 0"
"0","  }"
"0","    "
"0","  N[,i] <- round(mat[i-1,,] %*% N[,i-1])"
"0","}"
"0","Ntot = apply(N, 2, sum)"
"0","# urban"
"0","N.U = matrix(NA, nrow = 4, ncol = 30)"
"0","N.U[,1] <- init$`Initial number, urban habitat`[1:4]"
"0","  "
"0","# project with temporal variation"
"0","for(i in 2:30){"
"0","    "
"0","  # set fecundity = 0 if pop exceeds K"
"0","  if(sum(N.U[,i-1]) > (K*0.087)){"
"0","    mat.U[i-1,1,3:4] <- 0"
"0","  }"
"0","    "
"0","  N.U[,i] <- round(mat.U[i-1,,] %*% N.U[,i-1])"
"0","}"
"0","Ntot.U = apply(N.U, 2, sum)"
"0","data.frame(year = c(1:30),"
"0","           natural = Ntot, "
"0","           urban = Ntot.U) %>% "
"0","  mutate(total = natural+urban) %>% "
"0","  gather(habitat, N, 2:4) %>% "
"0","  mutate(habitat = fct_relevel(as.factor(habitat), ""total"")) %>% "
"0","  ggplot(aes(x = year, y = N, col = habitat)) +"
"0","  geom_line(aes(alpha = habitat)) +"
"0","  geom_point(aes(alpha = habitat)) +"
"0","  scale_color_manual(values = c(""black"", ""#F8766D"", ""#00BFC4""), name = """") +"
"0","  scale_alpha_manual(values = c(1, 0.5, 0.5), guide = F) +"
"0","  theme(legend.position = ""top"") +"
"0","  xlab(""Year"") +"
"0","  ylab(""Population size"")"
